<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>1.2 変数と型 - Rust入門</title>
</head>
<body>
<p><a href="index.html">目次に戻る</a></p>
<h1>1.2 変数と型（let, mut, 型推論）</h1>

<h2>C++/Kotlinとの比較</h2>
<table border="1" cellpadding="5">
<tr><th>概念</th><th>C++</th><th>Kotlin</th><th>Rust</th></tr>
<tr><td>不変変数</td><td>const int x = 5;</td><td>val x = 5</td><td>let x = 5;</td></tr>
<tr><td>可変変数</td><td>int x = 5;</td><td>var x = 5</td><td>let mut x = 5;</td></tr>
<tr><td>型明示</td><td>int x = 5;</td><td>val x: Int = 5</td><td>let x: i32 = 5;</td></tr>
</table>

<h2>重要: Rustの変数はデフォルトで不変</h2>
<pre>
fn main() {
    let x = 5;
    // x = 6;  // コンパイルエラー！

    let mut y = 5;
    y = 6;  // OK（mutをつけたので変更可能）
    println!("y = {}", y);
}
</pre>

<h2>基本の型</h2>
<pre>
fn main() {
    // 整数型
    let a: i32 = 42;      // 32bit符号付き（デフォルト）
    let b: i64 = 42;      // 64bit符号付き
    let c: u32 = 42;      // 32bit符号なし
    let d: usize = 42;    // ポインタサイズ（配列インデックスに使用）

    // 浮動小数点
    let e: f64 = 3.14;    // 64bit（デフォルト）
    let f: f32 = 3.14;    // 32bit

    // 真偽値
    let g: bool = true;

    // 文字（Unicode scalar value、4バイト）
    let h: char = 'あ';

    // 型推論
    let i = 100;          // i32と推論される
    let j = 3.14;         // f64と推論される
}
</pre>

<h2>シャドーイング</h2>
<p>Rustでは同名の変数を再定義できる（C++/Kotlinにない特徴）：</p>
<pre>
fn main() {
    let x = 5;
    let x = x + 1;        // 新しいxを定義（前のxを隠す）
    let x = x * 2;
    println!("x = {}", x);  // 12

    // 型を変えることも可能
    let spaces = "   ";       // &amp;str型
    let spaces = spaces.len(); // usize型に変わる
    println!("spaces = {}", spaces);  // 3
}
</pre>

<h2>タプル</h2>
<pre>
fn main() {
    // タプル（異なる型の値をまとめる）
    let tup: (i32, f64, char) = (500, 6.4, 'a');

    // 分解（destructuring）- Kotlinと同様
    let (x, y, z) = tup;
    println!("x={}, y={}, z={}", x, y, z);

    // インデックスアクセス
    println!("tup.0 = {}", tup.0);
    println!("tup.1 = {}", tup.1);
}
</pre>

<h2>定数</h2>
<pre>
// constはコンパイル時定数（C++のconstexprに近い）
const MAX_POINTS: u32 = 100_000;  // 型注釈必須、_は桁区切り

fn main() {
    println!("MAX = {}", MAX_POINTS);
}
</pre>

<h2>エクササイズ 1.2</h2>
<ol>
    <li>不変変数xに10を代入し、シャドーイングでx*2の値で上書きして出力</li>
    <li>mut変数を使って、1から5までカウントアップする変数を作り、最終値を出力</li>
    <li>タプルで(名前, 年齢, 身長)を表現し、分解して各要素を出力</li>
</ol>

<h3>解答例</h3>
<pre>
fn main() {
    // 1. シャドーイング
    let x = 10;
    let x = x * 2;
    println!("x = {}", x);  // 20

    // 2. mut変数でカウントアップ
    let mut count = 1;
    count = 2;
    count = 3;
    count = 4;
    count = 5;
    println!("count = {}", count);  // 5

    // 3. タプル
    let person = ("Taro", 25, 175.5);
    let (name, age, height) = person;
    println!("name={}, age={}, height={}", name, age, height);
}
</pre>

<hr>
<p><a href="ch01_01_hello.html">&lt;&lt; 前へ</a> | <a href="index.html">目次</a> | <a href="ch01_03_control.html">次へ: 1.3 制御構文 &gt;&gt;</a></p>
</body>
</html>
